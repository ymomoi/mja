# mja : 手動麻雀点数表示ボード MahJongg Assistant board

点数表示のない麻雀卓でプレイするときに点棒のやりとりをせずに遊ぶために作った、ニッチなプログラムです。
スマホやタブレットのブラウザで表示して使うために、固定サイズ/幅のシンプルなレイアウトをしています。
単なる表示器なので、精算時のウマ/オカなどは自分で計算してください。

## 使い方

iPad mini など、適当なサイズのタブレットに表示して使うことを想定しています。

![play](images/play.jpg)

HTML/CSSとJavaScript (jQuery) しか使ってません。サーバかローカルの適当な場所に置いて、Webブラウザでhtdocs/index.htmlを読み込めば動作します。

こちらで触ってみることができます: [動作デモ](http://bug.org/~momo/mja/)

### 主な想定ルール

- 下記の項目が右上の設定ボタンから設定できます。
    - 配給原点(初期値は25000点)
    - 30符4翻を満貫に切り上げるか(チェックがなければ子7700点、親11600点)
    - 一本場を1500点にするか(チェックがなければ300点)
    - 親権をあがり連荘にするか(チェックがなければ聴牌連荘)
    - 局/本場を精算/流局精算時に自動で進めるか(チェックがなければ自動では進めない)
- ダブロン、トリロン時の供託は上家どり、本場は全員につきます(操作方法は後述)
- 仕様と違う点棒のやりとりをしたい場合は、手動精算機能を使ってください

### 主な操作

- メンバー設定ボタン
    - p1〜p4に、起家から順番にプレイヤー名を入力しておくと、精算画面などが見やすいです
- サイコロボタン
    - サイコロを2個振ります
- 自風、焼き鳥(焼き豚)、点差表示
    - タップするとリーチできます
    - 焼き鳥(焼き豚)表示はおまけ機能なので、マニュアル操作できません
        - 真剣に使う日がきたら、操作できるようにします
- 各家の点数表示
    - タップすると、タップした人のあがりとして精算ダイアログが開きます
- 点数精算ダイアログ
    - 翻数と符を入力、あがったプレイヤー、放銃したプレイヤーを指定します
    - ツモあがりの場合は他3人を指定します
    - 供託、本場が自動計算され、親以外があがった場合は次の局に進みます
    - ダブロン、トリロン時の操作は後述します
- 流局精算ダイアログ
    - テンパイしていたプレイヤーを指定します
    - 親がノーテンの時は局が進みます

### マニュアル操作用

だいたいの場合は上の操作手順でいけますが、イレギュラー対応は手動でする必要があります。

- 0本場ボタン
    - 本場をクリアしたいときに押します
- 手動精算ボタン
    - 点数をプレイヤーと供託間でやりとりします
- 場風表示
    - タップすると東-南-西-北の順で表示されます
- 局表示
    - タップすると1局〜4局の順で表示されます
- リストアボタン
    - 場の状況を以前の局終了時に戻したいときに使います

### イレギュラー対応について

割り切って機能を絞り、点数表示に徹しているので、ある程度のイレギュラー対応が必要です。

- 七対子
    - 50符1翻で入力してください
- ダブロン、トリロン時の操作方法
    - 放銃者から見て上家の点数を精算(供託が含まれます)
        - 点数計算ダイアログで「連続精算」チェックボックスをチェックします(局が進みません)
    - 他家の点数を精算
        - 親があがり者に含まれている場合、全員の精算で「連続精算」チェックボックスをチェックします
            - 全員終わったら、「本場」をクリックして1本積みます
        - 親があがり者に含まれていない場合、最後の精算では「連続精算」チェックを外します(局が進みます)
- チョンボ時の精算方法
    - 手動精算ボタンを使ってください
- 誤リーチ、誤ポン、誤チーなどの罰符対応
    - 手動精算ボタンを使って、供託に点数を移動してください

## スクリーンショット

![screenshot1](images/sc-01.jpg)

![screenshot2](images/sc-02.png)

![screenshot4](images/sc-04.png)

![screenshot3](images/sc-03.jpg)

![screenshot5](images/sc-05.png)

![screenshot6](images/sc-06.png)

![screenshot7](images/sc-07.png)

## 使用したもの

- [jQuery](https://jquery.com)
- [jQueryUI](https://jqueryui.com)
- サイコロの画像と処理
    - [JavaScript：サイコロを振る](https://torisky.com/javascript%EF%BC%9A%E3%82%B5%E3%82%A4%E3%82%B3%E3%83%AD%E3%82%92%E6%8C%AF%E3%82%8B/)
- サイコロを振る音
    - [音人](https://on-jin.com/)
- リーチ音声
    - macOS の say コマンド
- 焼鳥(焼豚)イラスト
    - [イラストAC](https://www.ac-illust.com/)
